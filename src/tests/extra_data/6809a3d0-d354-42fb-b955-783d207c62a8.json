{
    "description": "Define the allow list of Azure Data Factory linked service types. Restricting allowed resource types enables control over the boundary of data movement. For example, restrict a scope to only allow blob storage with Data Lake Storage Gen1 and Gen2 for analytics or a scope to only allow SQL and Kusto access for real-time queries.",
    "displayName": "Azure Data Factory linked service resource type should be in allow list",
    "id": "/providers/Microsoft.Authorization/policyDefinitions/6809a3d0-d354-42fb-b955-783d207c62a8",
    "metadata": {
        "category": "Data Factory",
        "version": "1.1.0"
    },
    "mode": "All",
    "name": "6809a3d0-d354-42fb-b955-783d207c62a8",
    "parameters": {
        "allowedLinkedServiceResourceTypes": {
            "allowedValues": [
                "AdlsGen2CosmosStructuredStream",
                "AdobeExperiencePlatform",
                "AdobeIntegration",
                "AmazonRedshift",
                "AmazonS3",
                "AzureBlobFS",
                "AzureBlobStorage",
                "AzureDataExplorer",
                "AzureDataLakeStore",
                "AzureDataLakeStoreCosmosStructuredStream",
                "AzureDataShare",
                "AzureFileStorage",
                "AzureKeyVault",
                "AzureMariaDB",
                "AzureMySql",
                "AzurePostgreSql",
                "AzureSearch",
                "AzureSqlDatabase",
                "AzureSqlDW",
                "AzureSqlMI",
                "AzureSynapseArtifacts",
                "AzureTableStorage",
                "Cassandra",
                "CommonDataServiceForApps",
                "CosmosDb",
                "CosmosDbMongoDbApi",
                "Db2",
                "DynamicsCrm",
                "FileServer",
                "FtpServer",
                "GitHub",
                "GoogleCloudStorage",
                "Hdfs",
                "Hive",
                "HttpServer",
                "Informix",
                "Kusto",
                "MicrosoftAccess",
                "MySql",
                "Netezza",
                "Odata",
                "Odbc",
                "Office365",
                "Oracle",
                "PostgreSql",
                "Salesforce",
                "SalesforceServiceCloud",
                "SapBw",
                "SapHana",
                "SapOpenHub",
                "SapTable",
                "Sftp",
                "SharePointOnlineList",
                "Snowflake",
                "SqlServer",
                "Sybase",
                "Teradata",
                "HDInsightOnDemand",
                "HDInsight",
                "AzureDataLakeAnalytics",
                "AzureBatch",
                "AzureFunction",
                "AzureML",
                "AzureMLService",
                "MongoDb",
                "GoogleBigQuery",
                "Impala",
                "ServiceNow",
                "Dynamics",
                "AzureDatabricks",
                "AmazonMWS",
                "SapCloudForCustomer",
                "SapEcc",
                "Web",
                "MongoDbAtlas",
                "HBase",
                "Spark",
                "Phoenix",
                "PayPal",
                "Marketo",
                "Responsys",
                "SalesforceMarketingCloud",
                "Presto",
                "Square",
                "Xero",
                "Jira",
                "Magento",
                "Shopify",
                "Concur",
                "Hubspot",
                "Zoho",
                "Eloqua",
                "QuickBooks",
                "Couchbase",
                "Drill",
                "Greenplum",
                "MariaDB",
                "Vertica",
                "MongoDbV2",
                "OracleServiceCloud",
                "GoogleAdWords",
                "RestService",
                "DynamicsAX",
                "AzureDataCatalog",
                "AzureDatabricksDeltaLake"
            ],
            "defaultValue": null,
            "metadata": {
                "additionalProperties": null,
                "assignPermissions": null,
                "description": "The list of allowed linked service resource types.",
                "displayName": "Allowed linked service resource types",
                "strongType": null
            },
            "type": "Array"
        },
        "effect": {
            "allowedValues": [
                "Audit",
                "Deny",
                "Disabled"
            ],
            "defaultValue": "Audit",
            "metadata": {
                "additionalProperties": null,
                "assignPermissions": null,
                "description": "Enable or disable the execution of the policy",
                "displayName": "Effect",
                "strongType": null
            },
            "type": "String"
        }
    },
    "policyRule": {
        "if": {
            "allOf": [
                {
                    "equals": "Microsoft.DataFactory/factories/linkedservices",
                    "field": "type"
                },
                {
                    "field": "Microsoft.DataFactory/factories/linkedservices/type",
                    "notIn": "[parameters('allowedLinkedServiceResourceTypes')]"
                }
            ]
        },
        "then": {
            "effect": "[parameters('effect')]"
        }
    },
    "policyType": "BuiltIn",
    "systemData": null,
    "type": "Microsoft.Authorization/policyDefinitions"
}